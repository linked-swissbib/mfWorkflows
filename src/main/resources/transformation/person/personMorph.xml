<?xml version="1.0" encoding="UTF-8"?>

<metamorph xmlns="http://www.culturegraph.org/metamorph" version="1">

	<vars>
		<var name="swissbib_domain" value="http://data.swissbib.ch/resource/"/>
	</vars>

	<rules>

		<combine name="@key" value="${firstname}##${lastname}" flushWith="1001 ">
			<data source="1001 .a" name="firstname" />
			<data source="1001 .D" name="lastname" />
			<postprocess>
				<java class="org.swissbib.linked.mf.morph.functions.AuthorHash"/>
			</postprocess>
		</combine>
	
		<!--BUILD THE BASIS RECORD -->

		<entity name="foaf:Person" flushWith="record" >
			<data name="~rdf:about" source="@key" >
				<compose prefix="http://data.swissbib.ch/agent/" />
			</data>
			<combine name="rdfs:label" value="${firstname}${lastname}${developed}${dates}${note}" flushWith="1001 ">
				<data source="1001 .a" name="firstname" />
				<data source="1001 .D" name="lastname" >
					<compose prefix=", " />
				</data>
				<data source="1001 .q" name="developed" >
					<compose prefix=" (" postfix=")" />
				</data>
				<data source="1001 .d" name="dates" >
					<compose prefix=", " />
				</data>
				<data source="1001 .c" name="note" >
					<compose prefix=", " />
				</data>
			</combine>
			<data source="1001 .d" name="dbp:birthYear" >
				<regexp match="(\d\d\d\d).?[-]" format="${1}" />
			</data>
			<data source="1001 .d" name="dbp:deathYear" >
				<regexp match="(\d\d\d\d)$" format="${1}" />
			</data>
			<data source="1001 .a" name="foaf:lastName" />
			<data source="1001 .c" name="skos:note" />
			<data source="1001 .D" name="foaf:firstName" />
		</entity>
		
		<!--Must be completed with all author fields-->
		

			<!--100: MAIN AUTHOR-->
			<!--when first indicator is 1-->
			<!--
			<entity name="dc:contributor" flushWith="1001 " >
				<entity name="foaf:Person" flushWith="1001 " >
					<combine name="~rdf:about" value="${firstname}##${lastname}" flushWith="1001 ">
						<data source="1001 .a" name="firstname" />
						<data source="1001 .D" name="lastname" />
						<postprocess>
							<java class="org.swissbib.linked.mf.morph.functions.AuthorHash"/>
						</postprocess>
					</combine>
					<combine name="rdfs:label" value="${firstname}${lastname}${developed}${dates}${note}" flushWith="1001 ">
						<data source="1001 .a" name="firstname" />
						<data source="1001 .D" name="lastname" >
							<compose prefix=", " />
						</data>
						<data source="1001 .q" name="developed" >
							<compose prefix=" (" postfix=")" />
						</data>
						<data source="1001 .d" name="dates" >
							<compose prefix=", " />
						</data>
						<data source="1001 .c" name="note" >
							<compose prefix=", " />
						</data>
					</combine>
					<data source="1001 .d" name="dbp:birthYear" >
						<regexp match="(\d\d\d\d).?[-]" format="${1}" />
					</data>
					<data source="1001 .d" name="dbp:deathYear" >
						<regexp match="(\d\d\d\d)$" format="${1}" />
					</data>
					<data source="1001 .a" name="foaf:lastName" />
					<data source="1001 .c" name="skos:note" />
					<data source="1001 .D" name="foaf:firstName" />
				</entity>		
			</entity>
			-->
			
			<!--when first indicator is 0-->
			
			<!--<entity name="dc:contributor" flushWith="1000 " >
				<entity name="foaf:Person" flushWith="1000 " >
					<combine name="rdfs:label" value="${name}${dates}${note}" flushWith="1000 ">
						<data source="1000 .a" name="name" />
						<data source="1000 .d" name="dates" >
							<compose prefix=", " />
						</data>
						<data source="1000 .c" name="note" >
							<compose prefix=", " />
						</data>
					</combine>
					<data source="1000 .d" name="dbp:birthYear" >
						<regexp match="(\d\d\d\d).?[-]" format="${1}" />
					</data>
					<data source="1000 .d" name="dbp:deathYear" >
						<regexp match="(\d\d\d\d)$" format="${1}" />
					</data>
					<data source="1000 .a" name="foaf:name" />
					<data source="1000 .c" name="skos:note" />
				</entity>		
			</entity>-->

	</rules>

</metamorph>
